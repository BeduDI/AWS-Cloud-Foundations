# ¿Por que AWS?


# Interactuando con AWS y configuración de cuentas

# AWS Console, AWS CLI & AWS SDK
En general podemos interactuar con los recursos y servicios que brinda AWS de 3 modos distintos. 

## AWS Console: 
Para la gente visual, esta es la forma mas natural para tener un primer acercamiento con AWS, puedes entral al [portal web](console.aws.amazon.com/) de la consola de AWS y acceder para ver y gestionar los diferentes recursos que ofrece AWS.

Esta es la apariencia que tiene la consola de administración de AWS hasta Agosto del 2020.
![aws-console](aws-console.png)

El elemento principal de la consola es buscador de los servicios que ofrece, sin el buscador es fácil perderse entre los 175 que se ofrecen.
Desde aquí se pueden manejar: 

- Cuotas: Hay servicios de AWS que tienen límites predefinidos, por ejemplo con las instancias de máquinas virtuales (EC2) son [estos](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-on-demand-instances.html#ec2-on-demand-instances-limits).
![Cuotas](aws-console-cuotas.png), desde esta sección se puede apelar a aumentar las cuotas de los servicios si la operación de la organización así lo requiere. Es importante señalar que hay cuotas de tipo `soft` que pueden ser cambiadas solicitanto a AWS un aumento y de tipo `hard` que no pueden ser cambiadas. [Por ejemplo](https://docs.aws.amazon.com/mediapackage/latest/ug/live-quotas.html).

- Facturación: Tener visibilidad de los costos, presupuestos y métodos de pago es muy importante para la correcta gestión y estrategia en los activos de TI hospedados en AWS
![Facturacion](aws-console-facturacion.png). Aquí hay mucha ayuda visual sobre la cantidad de ninero gastada mes a mes, se puede entrar al detalle de la factuación para saber cuánto dinero es gastado por cada recurso de AWS, se pueden establecer presupuestos y alarmas si es que dichos presupuestos se rebasan, tambien puedes configurar el envpio de reportes con detalle para personas de tu organización en intervalos definidos.

- Configuración de la cuenta: Hay datos propios de la cuenta como nombre del propietario de al cuenta, algunos datos personales como teléfono y dirección, gestión de contraseña.
![mi cuenta](aws-console-mi-cuenta.png)

- Organizaciones: AWS provee los mecanismos necesarios para el manejo de múltiples cuentas centralizadamente.
![organizaciones](aws-console-organizaciones.png). Puedes por ejemplo manejar desde ahi las cuentas de tus clientes si provees algun servicio de consultoría, así tus clientes no tienen que darte acceso a su cuenta principal.


## AWS CLI

También existe la opción de manejar los recursos de AWS por medio de línea de comandos  disponible para los sistemas [operativos mas comunes](https://docs.aws.amazon.com/cli/latest/userguide/install-cliv2.html), es cómodo usar la línea de comandos ante tareas repetitivas que exijan automatización, ¿tienes que descargar archivos a diario desde S3?, puedese generar un script de linea de comandos que lo haga por ti, así no tienes que preocuparte por entrar a la consola web que tiende a ser mas lento el proceso.

![aws-cli](aws-cli.png)

# AWS SDK
Para los programadores tanbién hay opcion de manejar los servicios de AWS desde su [lenguaje de programación](https://aws.amazon.com/es/tools/) de preferencia, Ruby, Python, PHP, Node.js, .NET, JavaScript, C++, Go y Java son los lenguajes soportados. ¿Cómo lo puedo usar?, Puedese generar una aplicación web que en lugar de guardar las imágenes de las identificaciones de los usuarios en el disco duro del servidor las quieras guardar directamente en el servicio de S3 de AWS.

# Infraestructura Global de AWS (AWS Regions, Availability Zones, AWS Edge Locations, and Local Zones)

El concepto de nube puede sonar un tanto abstracto, pero al final no hay que dejar de recordar que son un conjunto de máquinas agrupadas en un edificio en algún lugar del planeta.

Amazon Web Services tiene centros de datos lleno de servidores por todo el planeta buscando brindar a los usuarios disponibilidad, rendimiento, escalabilidad, y flexibilidad.

Los conceptos claves que nos ayudarán a comprender como AWS tiene distribuidos todos sus servidores por el mundo son:
- Zonas de disponibilidad:
Los distintos centros de datos de Amazon por el mundo los agrupa en zonas de disponibilidad, las zonas de disponibilidad se encuentran físicamente muy cercanas unas de otras formando pequeñas agrupaciones. Cada zona de siponibilidad puede constar de mas de un centro de datos, cada zona de disponibilidad se comunica con otras zonas de diponiblidad por medio de enlaces de baja latencia.
La razón de sergmentar una zona de disponibilidad en varios centros de datos con algunos kilómetros de distancia es ser resilientes ante un desastre naturales, falla de energía eléctrica, atentados, o algún otro inconveniente, más adelante veremos que podemos maximizar la tolerancia a fallos de nuestros aplicativos si los alojamos en mas de una Zona de disponibilidad.

- Regiones: 
Son puntos geográficos distantes donde se agrupan varias zonas de disponibilidad.
AWS ocupa actualmente 245 países con 24 regiones lanzadas, anunciadas 3 por lanzar en Indonesia, Japón y España.

- Local Zones:
Aún en una etapa temprana de desarrollo, solo se eunuentra una local zone disponible en Los Angeles California, pretende proveer servicios de baja latencia a usuarios finales acercando la infraestructura de AWS sin necesidad de tener una zona de disponibilidad cercana.

- Wavelength:
Ofrecerá acceso ópimo en latencia a recursos de AWS por medio de redes 5G. Aún es un servicio muy cerrado a los Estados unidos de América.

- Edge locations:
Son centros de datos manejados por partners certificados de AWS que tiene conexion directa a la infraestructura de AWS. Es usado por los servicios como ROute53 (servicio de DNS), CloudFront (Content Delivery Network) y API Gateway (Creación publicacion y mantenimiento de API). La idea es proporcionar baja latencia a los usaurios finales no importando si se encuentran cerca de una región de AWS.



Ejemplo de las zonas de disponibilida de la región 1, en ella se aprecian las zonas de disponibilidad (conunto de centros de datos) conectadas por redes de baja latencia. Así si la zona de disponibilidad us-east-1f tiene bajo performance por fallas por energía eléctrica nuestras aplicaciones pueden seguir operando si están distribuidas en mas de una zona de disponibilidad. Algunos servicios como RDS te obligan al [provisionar](www.redhat.com/en/topics/automation/what-is-provisioning) una base de datos con redes en dos zonas de disponibilidad como mínimo. 

### Nota: En general los servicios de AWS son muy resistentes a fallas, hay que evaluar bien si la aplicacion a ejecutar justifica el uso de recursos replicados en mas de una zona de disponibilidad, ya que los recursos replicados aunque no se usen al final cuestan prácticamente lo mismo que los recursos que si se estan utilizando, dicho de otro modo, la infraestructura total cuesta aproxiamdamente el doble.

![aws-regions-availability-zone](aws-regions-availability-zone.png)


En general todos los servicios que ofrece AWS son inherentes a una región específica, si deseas provisionar una servidor virtual (EC2) en China habrá que desplazarse en la consola AWS (o especificar en aws-cli o aws-sdk) a la región deseada. Aunque hay algunas excepciones, servicios como IAM (gestión de usuarios, políticas de acceso y permisos), Cloud CloudFront (Content Ddelivery Network) y S3 (Almacenamiento masivo de archivos) se consideran que no pertencen a ninguna región específica, son considerados servicios globales. 

# Servicios Centrales
Los siguientes servicios son centrales para tener una unidad de procesamiento computacional operando en AWS:

- IAM: Por un lado nos encontramos con Identity and Access Management, desde aquí se pueden configurar las cuentas que podrán acceder a la AWS Console y a la AWS CLI y AWS SDK, con ellas no solo controlamos la autorización (es decir que nos acrediten ser quienes decimos que somos), tambien controlamos la Autenticación (sabemos quien tiene acceso a hacer que cosa), esto es una herramienta clave (no es la única) a la hora de cumplir con regulaciones tanto internas como externas a nuestra organización como  [PCI DSS](https://www.pcisecuritystandards.org/pci_security/)
Los conceptos clave para entender IAM son:

* - Políticas (Policies): Responde a la pregunta ¿A qué debo dar permiso acceder?, una política define los `servicios` a los cuales se tendrá permitido acceder, las `acciones` que puede hacer en el servicio como lectura y/o escritura (cada servicio tiene su set de acciones permitidas), tambien se deben definir los `recursos`, los recursos especifican de manera muy granular dentro de un servicio (por ejemplo S3) que no se permita el acceso a todos los buckets de S3 existentes si no solo dar acceso a buckets muy específicos (aunque se puede dar acceso a todos) normalmente por medio del ARN del recurso (ejemplo del arn de un bucket real arn:aws:s3:::aws-athena-query-results-001513791584-us-east-1) y finalmente se especifican las `condiciones`, cuando una cuenta de consola, cli/sdk generan un acción (como leer un archivo) esta petición (`request`) lleva un contexto, es decir lleva juto con la accion información extra, en concreto La accion de la operación, el recurso, datos de entorno coo dirección ip, user agent, SSL y la hora y fecha. Con esos datos de contexto podemos definir por ejemplo que solo sea aplicable la política siempre que se quiera acceder al sistema desde una IP específica.
Así cuando se quiere escribir (acción) nuestro archivo en un bucket (recurso) de S3 (servicio) AWS verifica que estemos autenticados, después procesa el contxto de la petición para ver si la política debe aplicar o no, evalúa la política que será aplicada (se reevaluan las políticas ya que múltiples políticas pueden ser aplicadas a un mismo recurso), una vez hecho todo esto se determina si la accion es una accion autorizada, de no serlo se rechaza la ejecución.

* - Roles: No solo es posible conceder acceso a AWS por medio de credenciales específicas, se puede conceder acceso a entidades como otros servicios de AWS y Otras cuentas de AWS, el caso de uso: Tengo una lambda con la que quiero para tomar los archivos previamente alojados en S3 los procese y finalmente guarde todo en base de datos cada 15 minutos, podemos en ese caso diseñar un rol específico donde por medio de uan política asociada a ese rol le dé acceso al bucket de s3 muy concreto.

* - Usuarios (users): Básicamente es la representación de una persona on una aplicación. No es en el sentido estrictto un usuario, se puede ver como una entidad que puede acceder a un recurso de AWS ya sea por medio de la consola, del cli/sdk u ambos. AWS tambien llama a estas figuras `principals`

* - Grupos (groups) : Por buena práctica de seguridad deberíamos crear tantos usuarios como accesos por distintas entidades requieran acceso a nuestros recursos, lo que fácilmente se puede salir de control, por ello los grupos se vuelven una herramienta valiosa para que nos permite asocial políticas y usuarios (entiendase usuario al concepto anterior), en resumen, le podemos decir a AWS: "a este conjunto de usuarios necesito que le aplique esta o esta serie de políticas", el caso de uso: puedo generar un rol de auditor, donde a ese sol le asocio políticas necesarias para restringir el acceso a los recursos de AWS necesarios, despues puedo conceder acceso a varios de esos usuarios que deberían cada uno de ellos tener su propia cuenta de suaurio, así, en lugar de asociar una política (o varias) a cada usuario basta con solo asociar al usuario al grupo y en automático le aplicarían todas las políticas esocidas al grupo.

# TODO Una ilustracion que ejemplifique estos conceptos


- VPC (Virtual Private Cluod):
Los recursos de AWS deben comunicarse unos con otros, par alo cual el tema de redes se hace un tema crucial, aqui podemos generar segmentos de red específicos para cada entorno por ejemplo, así no aseguramos que los entornos de desarrollo y producción no se puedan comunicar a nivel de red.

## TODO Desarrollar todo lo necesario para explicar los conceptos clave de VPC


- S3 (`S`imple `S`torage `S`ervice):
EL servicio para guardado de datos prácticamente "infinito", de simple no tiene nada, es un servicio muy interesante donde podemos guardar gigas y gigas de archivos (tambien conocidos como objetos) sin necesidad de tener conectado este storage a ningún sistema operativo, simplemente con una conexion http podemo ahacer uso de él. Tiene un 99.999999999% de durabilidad de archivos por año, lo que quiere decir que si se almacenan 10000 objetos se espera en una perdida de un objecto cada 10,000,000 de años, aunque esto dependerá mucho de como configuremos nuestros buckets. 
Los buckets son la unidad lógica mínima donde guardaremos información, antede de poder guardar cualquier tipod e archivo debemos crear un bucket, a grandes rasgos podemos verlo como una carpeta con configuraciones bien definidas para cifrado, niveles de servicio, políticas de acceso, replicación, manejo del ciclo de vida de los archivos, esta útlima muy interesante, podemos definir cuando nuestros archivos pueden moverse a otros niveles de servicio de s3 en pro de reducir costos, ej: mueve todas las facturas del bucket a un nivel mas barato si en 90 días no se usan. 
S3 proporciona mecanismo para brindar almacenamiento en distintos niveles de servicio, podemos guardar archivos a precios mas baratos pero no ofrecería acceso de manera inmediata si no que puede tardar el acceso a los archivos desde varios minutos hasta varias horas, tambien podemos escoger una configuracion especial para guardar archivos sin replicación entre zonas de disponibilidad, por defecto S3 replica la información por medio de varias zonas de disponibilidad, de poner nuestros archivos en esta configuración se pueden poerder si es que AWS pediera por algún motivo la zona de desponibilidad donde se encuentran alojados. 

|                          Storage | Precio                   | Desempeño y latencia                        | Disponibilidad | Durabilidad   |
|---------------------------------:|--------------------------|---------------------------------------------|----------------|---------------|
| S3 Estándar                      | 0,023 USD por GB / Mes   | Baja latencia y alto nivel de procesamiento | 99,99%         | 99.999999999% |
| S3 Intelligent-Tiering           | 0.023 USD por GB / mes   | Mismo de S3 Estándard                       | 99.99%         | 99.999999999% |
| Estándar – Acceso poco frecuente | 0.0125 USD por GB / mes  | Mismo de S3 Estándard                       | 99.9 %         | 99.999999999% |
| S3 Única zona                    | 0.01 USD por GB / mes    | Mismo de S3 Estándard                       | 99.5%          | 99.999999999% |
| S3 Glacier                       | 0,004 USD por GB / mes   | Minutos u horas                             | 99.99%         | 99.999999999% |
| Glacier Deep Archive             | 0.00099 USD por GB / Mes | Horas                                       | 99.99%         | 99.999999999% |
| Reduced Redundancy Storage       | 0.024 USD por GB / Mes   | Mismo de S3 Estándard                       | 99.99%         | 99.99%        |

Los conceptos clave de la tabla anterior son durabilidad y disponibilidad, la primera refiere a la probabilidad de perder un objeto cada año, la segunda es el porcentaje de tiempo que un objeto será accesible en un año.

Ejemplos de buckets.
![bucket](buckets.png)

Transición a los distintos almacenamientos:
![almacenamientos](ciclo-de-vida.png)


Un uso interesante ademas de guardar la sfacturas de nuestros clientes que por reglamentación oficial en México debemos tenerlas almacenadas por 5 años a bajo costo por ejemplo, es la posibilida de habilitar un bucket de S3 como un servidor web estático. Hay algunas consideraciones, para poder darle un dominio a ese bucket el DNS de nuestro dominio debe ser manejado por el servicio Route53, y para poder habilitar el certificado https debemos ahcer uso de AWS CloudFront. 


- EC2 y EBS
Los servicios básicos de IaaS que en conjunto nos permiten tener una maquina virtual con acceso al sistema operativo, se pueden especificar las interfaces de red, configurar un firewal para acceder a ella, especificar la red y el direccionamiento IP que debe tener

# Todo desarrollar mas el concepto.


# Infraestructura, recursos y herramientas de soporte***
# Niveles y planes de AWS Support
# Cloud Economics
# Creación de presupuestos con AWS Budget
# Organización y optimización de costos en AWS
# AWS TCO Calculator, AWS Simple Monthly Calculator & Cost Explorer